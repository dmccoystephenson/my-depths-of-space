!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tactics=t():e.tactics=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Start:()=>U,StartMainMenu:()=>M});const n=JSON.parse('[{"name":"tileset","image":null,"filename":"./images/FullTileset.png"}]');var o=null;function i(){return o}let l=null,r=null,a="";const c=JSON.parse('{"d":{"moveUp":"ArrowUp","moveDown":"ArrowDown","moveLeft":"ArrowLeft","moveRight":"ArrowRight","attack":" ","select":"Shift","cancel":"Escape"},"v":{"moveUp":"button12","moveDown":"button13","moveLeft":"button14","moveRight":"button15","attack":"button0","select":"button7","cancel":"button1"}}');var d=!1;function f(e){w(e,!1),u[e]&&u[e](e)}var s={},u={},m=["keyboard","gamepad"];function w(e,t){s[e]=t}function p(e){if(!d)return;let t=Object.keys(c.d);for(let n in t)e.key===c.d[t[n]]&&w(t[n],!0)}function g(e){if(!d)return;console.log(e);let t=Object.keys(c.d);for(let n in t)e.key===c.d[t[n]]&&f(t[n])}s={},u={},m.includes("keyboard")&&(window.removeEventListener("keydown",p),window.removeEventListener("keyup",g),window.addEventListener("keydown",p),window.addEventListener("keyup",g)),m.includes("gamepad")&&gameControl.on("connect",(function(e){let t=Object.keys(c.v);for(let n in t)e.on(c.v[t[n]],(()=>{})).after(c.v[t[n]],(()=>{f(t[n])}))})),d=!1;const y={listen:()=>{d=!0},unlisten:()=>{d=!1},released:(e,t)=>{u[e]=t}},h=JSON.parse('[{"id":"Main","Style":{"Color":"#c1c1c1ff","SelectColor":"#f1f1f1ff","SelectableColor":"#ccccccff"},"Options":[{"text":"Start","onSelect":"menu_GameSetup","width":"90%"},{"text":"Settings","onSelect":"menu_Settings","width":"90%"},{"text":"Credits","onSelect":"menu_Credits","width":"90%"}]},{"id":"Settings","onLoad":"callback_StartSettings","Options":[{"text":"Input Type","width":"90%"}]}]');let v=null,S=null;var b="Main",x="Start",k={menu_GameSetup:()=>{U()}};let O=0,I=0;var j=Date.now(),C=Date.now(),D=16,E="mainMenu";function L(){(j=Date.now())-C>=D&&("mainMenu"===E?(S||(S=i()),S.clearRect(0,0,240,160),v||(v=new imui.ImUI(S.canvas),v.font=font,v.onUpdate=e=>{let t=h.filter((e=>e.id===b))[0],n=t.Options,o=I+30;for(let i in n){let l=n[i].text,r=n[i],a=l===x?t.Style.SelectColor:r.onSelect?t.Style.SelectableColor:t.Style.Color;e.Element({id:"lblMenu"+b+l,text:`${x===l?">":" "}${l}${x===l?"<":" "}`,rect:{x:O,y:o,w:64,h:8},color:a,highlight:a,bgcolor:"#cccccc00"}),o+=12}}),v.Draw()):"main"===E&&(r||(r=i()),r.clearRect(0,0,240,160),l||(l=new imui.ImUI(r.canvas),l.font=font,l.onUpdate=e=>{e.Element({id:"lblTooltip",text:a,rect:{x:0,y:0,w:240,h:10},color:"#f1f1f1ff",highlight:"#f1f1f1ff",bgcolor:"#cccccc00"})}),l.Draw()),C=j),window.requestAnimationFrame(L)}async function M(){await function(){let e=[];for(let t in n){let o=n[t];e.push(new Promise(((e,t)=>{return(i=o.filename,new Promise(((e,t)=>{let o=new Image;o.onload=t=>{e(o)},o.onerror=e=>{console.error(`Failed to load file ${i}:`,e),t(null)},n.filter((e=>e.filename===i)).length>0?o.src=i:(console.error(`Image definition matching filename ${i} not found.`),t(null))}))).then((t=>{o.image=t,e(t)})).catch((e=>console.error("Failed to load",o.filename,e)));var i})))}return Promise.allSettled(e)}();let e=document.getElementById("maincanvas"),t=e.width/e.height;var i;e.style.height=window.innerHeight+"px",e.style.width=window.innerHeight*t+"px",window.addEventListener("resize",(()=>{e.style.height=window.innerHeight+"px",e.style.width=window.innerHeight*t+"px"})),D=parseInt(1e3/60),i=e.getContext("2d"),o=i,function(e){y.listen();let t=h.filter((e=>e.id===b))[0].Options,n=t.filter((e=>e.text===x))[0];y.released("moveDown",(()=>{let e=t.findIndex((e=>e.text===x));e++,e>=t.length&&(e=0),x=t[e].text})),y.released("moveUp",(()=>{let e=t.findIndex((e=>e.text===x));e--,e<0&&(e=t.length-1),x=t[e].text})),y.released("attack",(()=>{n.onSelect&&k[n.onSelect]()}))}(),window.requestAnimationFrame(L)}async function U(){y.unlisten(),E="main"}return t})()));
//# sourceMappingURL=tactics.js.map